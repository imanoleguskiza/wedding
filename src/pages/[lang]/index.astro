---
import Base from '../../layouts/Base.astro';
import { languages, translations, type Lang, type Translation } from '../../lib/i18n';

export function getStaticPaths() {
  return languages.map((lang) => ({
    params: { lang },
    props: { lang, t: translations[lang] }
  }));
}

const langParam = (Astro.params.lang as Lang) ?? (Astro.props as any)?.lang ?? 'en';
const lang: Lang = languages.includes(langParam) ? langParam : 'en';
const t: Translation = (Astro.props as any)?.t ?? translations[lang];

const heroImages: Record<Lang, { desktop: string; mobile: string }> = {
  en: { desktop: '/hero.png', mobile: '/hero_mobile.png' },
  es: { desktop: '/hero_es.png', mobile: '/hero_mobile_es.png' },
  bg: { desktop: '/hero_bg.png', mobile: '/hero_mobile_bg.png' }
};
const heroImage = heroImages[lang];
---
<Base lang={lang} page="home" t={t}>
  <section class="hero">
    <picture class="hero-figure">
      <source media="(max-width: 720px)" srcset={heroImage.mobile} sizes="90vw" />
      <img
        src={heroImage.desktop}
        alt="Couple portrait"
        loading="lazy"
        decoding="async"
        sizes="(max-width: 720px) 90vw, 980px"
      />
    </picture>
    <div>
      <div class="rule" aria-hidden="true"></div>
      <h1>{t.hero.names}</h1>
      <div class="meta">{t.hero.subtitle}</div>
      <div class="rule" aria-hidden="true"></div>
    </div>
  </section>

  <div class="hero-context" set:html={t.hero.context}></div>

  <section>
    <div class="section-title">{t.scheduleTitle}</div>
    <div class="timeline">
      {t.schedule.map((item) => (
        <div class="timeline-entry">
          <div class="subtitle">{item.subtitle}</div>
          <div class="time">{item.time}</div>
          <h3>{item.title}</h3>
          <div class="details">{item.details}</div>
          <div class="description">{item.description}</div>
          {item.badge && <div class="badge" style="margin-top: 0.75rem;">{item.badge}</div>}
        </div>
      ))}
    </div>
  </section>
</Base>
